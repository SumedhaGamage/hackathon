import json
import os

import boto3


class SQSClient:

    def __init__(self):
        self.queueURL = os.environ.get('PUSH_NOTIFICATION_SQS_URL')
        self.smsQueueURL = os.environ.get('SMS_NOTIFICATION_SQS_URL')
        self.client = boto3.client('sqs')

    def publish_push_notification(self, message):
        print("sending message")
        print(message)
        return self.client.send_message(QueueUrl=self.queueURL, MessageBody=message)

    def publish_sms_notification(self, message):
        return self.client.send_message(QueueUrl=self.smsQueueURL, MessageBody=message)
