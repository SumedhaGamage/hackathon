import os
import json
import urllib3


class SmsClient:

    def __init__(self):
        self.host = os.environ.get('SMS_API')
        self.sender_id = os.environ.get('SMS_SENDER_ID')
        self.api_key = os.environ.get('SMS_API_KEY')
        self.api_token = os.environ.get('SMS_API_TOKEN')
        self.http_client = urllib3.PoolManager()

    def send_sms(self, to, message):
        url = "{}?sendsms&apikey={}&apitoken={}&type=sms&from={}&to={}&text={}&scheduledate=2020-09-21%2009:13:05&route=0"\
            .format(self.host, self.api_key, self.api_token, self.sender_id, to, message)
        response = self.http_client.request('GET', url)
        if response.status == 200:
            return True, response.data
        else:
            print('Error in send sms {}'.format(response.data))
            return False, response.data