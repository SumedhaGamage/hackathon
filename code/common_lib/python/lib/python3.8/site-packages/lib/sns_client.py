import json
import os

import boto3


class SNSClient:

    def __init__(self):
        self.topic_arn = os.environ.get('SNS_TOPIC_ARN')
        self.client = boto3.client('sns')

    def publish(self, subject, message):
        return self.client.publish(
            TargetArn=self.topic_arn,
            Subject=subject,
            Message=json.dumps({'default': json.dumps(message)}),
            MessageStructure='json'
        )