import json
import os

import boto3

CHARSET = "UTF-8"

# Issue https://forums.aws.amazon.com/thread.jspa?threadID=63137


class SESClient:

    def __init__(self):
        self.client = boto3.client('ses')

    def send(self, sender, receiver, subject, body_html, body_text):
        try:
            return True, self.client.send_email(
                Destination={
                    'ToAddresses': [
                        receiver,
                    ],
                },
                Message={
                    'Body': {
                        'Html': {
                            'Charset': CHARSET,
                            'Data': body_html,
                        },
                        'Text': {
                            'Charset': CHARSET,
                            'Data': body_text,
                        },
                    },
                    'Subject': {
                        'Charset': CHARSET,
                        'Data': subject,
                    },
                },
                Source=sender,
            )
        except Exception as e:
            print("email sent failed", e)
            return False, None